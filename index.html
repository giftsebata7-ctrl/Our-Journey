<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For Rumbidzo Mutumhe ❤️</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

    <style>
        :root { 
            --gold: linear-gradient(to right, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
            --gold-static: #d4af37;
            --cream: #fff5f7;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            font-family: 'Montserrat', sans-serif;
            background: #2e0308;
            overflow: hidden; display: flex; justify-content: center; align-items: center;
        }

        /* Vignette - Pointer events NONE ensures it can't block clicks */
        body::after {
            content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, transparent 30%, rgba(0,0,0,0.8) 100%);
            pointer-events: none; z-index: 10;
        }

        #game-container {
            background: rgba(30, 0, 5, 0.95);
            backdrop-filter: blur(20px);
            border: 2px solid var(--gold-static);
            padding: 30px; border-radius: 40px;
            text-align: center; max-width: 450px; width: 92%;
            z-index: 100; color: var(--cream); position: relative;
        }

        .shimmer {
            background: var(--gold); -webkit-background-clip: text;
            -webkit-text-fill-color: transparent; font-family: 'Great Vibes', cursive;
        }

        .btn {
            background: transparent; color: var(--gold-static); border: 2px solid var(--gold-static);
            padding: 15px; border-radius: 12px; cursor: pointer; display: block;
            font-size: 1rem; font-weight: 600; text-transform: uppercase;
            width: 100%; margin-top: 20px;
            position: relative; z-index: 200; /* Highest possible z-index */
        }

        .screen { display: none; opacity: 0; transition: opacity 0.5s; }
        .visible { display: block; opacity: 1; }
        
        #final-letter { text-align: left; overflow-y: auto; max-height: 60vh; }
        #love-counter { font-size: 0.85rem; color: var(--gold-static); margin: 10px 0; font-weight: bold; text-align: center; }
        .hidden { display: none !important; }
    </style>
</head>
<body>

<div id="music-box" style="display:none;"><div id="player"></div></div>

<div id="game-container">
    <div id="screen-intro" class="screen visible">
        <h2 style="letter-spacing: 5px; font-size: 0.8rem;">DEAREST</h2>
        <h1 class="shimmer" style="font-size: 3rem;">Rumbidzo</h1>
        <p>Answer 5 questions to open my heart.</p>
        <button class="btn" id="start-btn">Open My Heart</button>
    </div>

    <div id="screen-game" class="screen">
        <div id="time" style="font-size: 2rem; color: var(--gold-static); border: 2px solid var(--gold-static); width: 60px; height: 60px; border-radius: 50%; margin: 0 auto; line-height: 55px;">08</div>
        <h2 id="question" style="font-family: 'Great Vibes', cursive; color: var(--gold-static); font-size: 2rem;">Question</h2>
        <div id="options"></div>
    </div>

    <div id="screen-proposal" class="screen">
        <h1 class="shimmer">Will you be my Valentine?</h1>
        <button class="btn" id="yes-btn">Yes, I will ❤️</button>
    </div>

    <div id="screen-letter" class="screen">
        <div id="final-letter">
            <h1 class="shimmer" style="text-align: center;">To Mama Qhawe</h1>
            <div id="love-counter"></div>
            <div id="typing-text" style="line-height: 1.6;"></div>
            <h2 class="shimmer" style="text-align: right;">Gift Sebata</h2>
        </div>
    </div>
</div>

<script>
    const startDate = new Date("2024-04-01T10:48:00-05:00");
    const msg = "I love you, my Mama Qhawe. Words truly cannot express how much you mean to me, although I struggle sometimes to express it. I am so grateful for the journey we have travelled so far—the ups and downs, the highs and the lows. We have been through it all, and I am so glad that God has been on our side, allowing us to make it this far to our second Valentine’s Day. I see you, I appreciate you, and most importantly—NDOKUDA. I can't wait for the new chapter we have started together.";

    // YouTube Setup
    var tag = document.createElement('script'); tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
    var player;
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', { height: '0', width: '0', videoId: 'rtOvBOTyX00', playerVars: { 'autoplay': 0, 'playlist': 'rtOvBOTyX00' }});
    }

    // Love Counter
    setInterval(() => {
        const diff = new Date() - startDate;
        const d = Math.floor(diff / 86400000);
        const h = Math.floor((diff / 3600000) % 24);
        const m = Math.floor((diff / 60000) % 60);
        const s = Math.floor((diff / 1000) % 60);
        document.getElementById("love-counter").innerHTML = `${d}d ${h}h ${m}m ${s}s of Love`;
    }, 1000);

    // Navigation
    function show(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('visible'));
        document.getElementById(id).classList.add('visible');
    }

    // Game Logic
    let step = 0;
    const scenarios = [
        { q: "Our first date?", ops: ["Sorrel", "Basket", "Queen", "Barcellos"], correct: 0 },
        { q: "What I wore?", ops: ["Formal", "PSG", "Liverpool", "Plain"], correct: 1 },
        { q: "Why so shy?", ops: ["Charm", "Handsome", "Mute", "All"], correct: "ANY" },
        { q: "Proposal date?", ops: ["June", "Dec", "Oct", "April 1"], correct: 3 },
        { q: "Most beautiful?", ops: ["T", "R", "Mama Q", "Mrs S"], correct: "ANY" }
    ];

    document.getElementById('start-btn').addEventListener('click', () => {
        if(player && player.playVideo) player.playVideo();
        show('screen-game');
        nextQ();
    });

    function nextQ() {
        if(step >= scenarios.length) { show('screen-proposal'); return; }
        const data = scenarios[step];
        document.getElementById('question').innerText = data.q;
        const optBox = document.getElementById('options');
        optBox.innerHTML = '';
        data.ops.forEach((o, i) => {
            const b = document.createElement('button');
            b.className = 'btn'; b.innerText = o;
            b.onclick = () => { step++; nextQ(); };
            optBox.appendChild(b);
        });
    }

    document.getElementById('yes-btn').addEventListener('click', () => {
        confetti({ particleCount: 150 });
        show('screen-letter');
        document.body.style.backgroundImage = "linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('background.jpg')";
        let i = 0;
        const type = setInterval(() => {
            document.getElementById('typing-text').innerHTML += msg.charAt(i);
            i++; if(i >= msg.length) clearInterval(type);
        }, 40);
    });
</script>
</body>
</html>
